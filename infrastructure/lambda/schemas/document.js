"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DeleteDocumentDTOSchema = exports.UpdateDocumentDTOSchema = exports.CreateDocumentDTOSchema = exports.DocumentItemSchema = void 0;
const zod_1 = require("zod");
const common_1 = require("../constants/common");
const document_1 = require("../constants/document");
//
// ================================
// DOCUMENT SCHEMA (DB Item)
// ================================
//
// Partition key and sort key for the shared DynamoDB table.
exports.DocumentItemSchema = zod_1.z.object({
    // DynamoDB keys
    [common_1.PK_NAME]: zod_1.z.literal(document_1.DOCUMENT_PK), // PK = "DOCUMENT"
    [common_1.SK_NAME]: zod_1.z.string(), // SK = "KB#<knowledgeBaseId>#DOC#<id>"
    // Document metadata
    id: zod_1.z.string(), // uuid
    knowledgeBaseId: zod_1.z.string(), // belongs to this KB
    name: zod_1.z.string(),
    fileKey: zod_1.z.string(), // original PDF / uploaded file
    textFileKey: zod_1.z.string(), // extracted text file in S3
    indexStatus: zod_1.z.enum(['pending', 'processing', 'ready', 'failed']),
    indexVectorKey: zod_1.z.string().optional(), // embeddings file or vector DB key
    createdAt: zod_1.z.string(),
    updatedAt: zod_1.z.string(),
});
//
// ================================
// DTOs (API Input)
// ================================
//
// CREATE
exports.CreateDocumentDTOSchema = zod_1.z.object({
    knowledgeBaseId: zod_1.z.string(),
    name: zod_1.z.string(),
    fileKey: zod_1.z.string(),
    textFileKey: zod_1.z.string()
});
// UPDATE
exports.UpdateDocumentDTOSchema = zod_1.z.object({
    id: zod_1.z.string(),
    knowledgeBaseId: zod_1.z.string(), // required for locating the SK
    name: zod_1.z.string().optional(),
    indexStatus: zod_1.z.enum(['pending', 'processing', 'ready', 'failed']).optional(),
    indexVectorKey: zod_1.z.string().optional(),
});
// DELETE
exports.DeleteDocumentDTOSchema = zod_1.z.object({
    id: zod_1.z.string(),
    knowledgeBaseId: zod_1.z.string(),
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9jdW1lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJkb2N1bWVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw2QkFBd0I7QUFDeEIsZ0RBQXVEO0FBQ3ZELG9EQUFvRDtBQUVwRCxFQUFFO0FBQ0YsbUNBQW1DO0FBQ25DLDRCQUE0QjtBQUM1QixtQ0FBbUM7QUFDbkMsRUFBRTtBQUVGLDREQUE0RDtBQUMvQyxRQUFBLGtCQUFrQixHQUFHLE9BQUMsQ0FBQyxNQUFNLENBQUM7SUFDekMsZ0JBQWdCO0lBQ2hCLENBQUMsZ0JBQU8sQ0FBQyxFQUFFLE9BQUMsQ0FBQyxPQUFPLENBQUMsc0JBQVcsQ0FBQyxFQUFVLGtCQUFrQjtJQUM3RCxDQUFDLGdCQUFPLENBQUMsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLEVBQXNCLHVDQUF1QztJQUVsRixvQkFBb0I7SUFDcEIsRUFBRSxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsRUFBc0IsT0FBTztJQUMzQyxlQUFlLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFTLHFCQUFxQjtJQUN6RCxJQUFJLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtJQUNoQixPQUFPLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFpQiwrQkFBK0I7SUFDbkUsV0FBVyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsRUFBYSw0QkFBNEI7SUFFaEUsV0FBVyxFQUFFLE9BQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUUsWUFBWSxFQUFFLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztJQUNqRSxjQUFjLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRSxFQUFFLG1DQUFtQztJQUUxRSxTQUFTLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtJQUNyQixTQUFTLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtDQUN0QixDQUFDLENBQUM7QUFLSCxFQUFFO0FBQ0YsbUNBQW1DO0FBQ25DLG1CQUFtQjtBQUNuQixtQ0FBbUM7QUFDbkMsRUFBRTtBQUVGLFNBQVM7QUFDSSxRQUFBLHVCQUF1QixHQUFHLE9BQUMsQ0FBQyxNQUFNLENBQUM7SUFDOUMsZUFBZSxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUU7SUFDM0IsSUFBSSxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUU7SUFDaEIsT0FBTyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUU7SUFDbkIsV0FBVyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUU7Q0FDeEIsQ0FBQyxDQUFDO0FBS0gsU0FBUztBQUNJLFFBQUEsdUJBQXVCLEdBQUcsT0FBQyxDQUFDLE1BQU0sQ0FBQztJQUM5QyxFQUFFLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtJQUNkLGVBQWUsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLEVBQUcsK0JBQStCO0lBQzdELElBQUksRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxFQUFFO0lBQzNCLFdBQVcsRUFBRSxPQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxFQUFFLFlBQVksRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUU7SUFDNUUsY0FBYyxFQUFFLE9BQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7Q0FDdEMsQ0FBQyxDQUFDO0FBS0gsU0FBUztBQUNJLFFBQUEsdUJBQXVCLEdBQUcsT0FBQyxDQUFDLE1BQU0sQ0FBQztJQUM5QyxFQUFFLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRTtJQUNkLGVBQWUsRUFBRSxPQUFDLENBQUMsTUFBTSxFQUFFO0NBQzVCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgUEtfTkFNRSwgU0tfTkFNRSB9IGZyb20gJy4uL2NvbnN0YW50cy9jb21tb24nO1xuaW1wb3J0IHsgRE9DVU1FTlRfUEsgfSBmcm9tICcuLi9jb25zdGFudHMvZG9jdW1lbnQnO1xuXG4vL1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIERPQ1VNRU5UIFNDSEVNQSAoREIgSXRlbSlcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vL1xuXG4vLyBQYXJ0aXRpb24ga2V5IGFuZCBzb3J0IGtleSBmb3IgdGhlIHNoYXJlZCBEeW5hbW9EQiB0YWJsZS5cbmV4cG9ydCBjb25zdCBEb2N1bWVudEl0ZW1TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIC8vIER5bmFtb0RCIGtleXNcbiAgW1BLX05BTUVdOiB6LmxpdGVyYWwoRE9DVU1FTlRfUEspLCAgICAgICAgIC8vIFBLID0gXCJET0NVTUVOVFwiXG4gIFtTS19OQU1FXTogei5zdHJpbmcoKSwgICAgICAgICAgICAgICAgICAgICAvLyBTSyA9IFwiS0IjPGtub3dsZWRnZUJhc2VJZD4jRE9DIzxpZD5cIlxuXG4gIC8vIERvY3VtZW50IG1ldGFkYXRhXG4gIGlkOiB6LnN0cmluZygpLCAgICAgICAgICAgICAgICAgICAgIC8vIHV1aWRcbiAga25vd2xlZGdlQmFzZUlkOiB6LnN0cmluZygpLCAgICAgICAgLy8gYmVsb25ncyB0byB0aGlzIEtCXG4gIG5hbWU6IHouc3RyaW5nKCksXG4gIGZpbGVLZXk6IHouc3RyaW5nKCksICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsIFBERiAvIHVwbG9hZGVkIGZpbGVcbiAgdGV4dEZpbGVLZXk6IHouc3RyaW5nKCksICAgICAgICAgICAgLy8gZXh0cmFjdGVkIHRleHQgZmlsZSBpbiBTM1xuXG4gIGluZGV4U3RhdHVzOiB6LmVudW0oWydwZW5kaW5nJywgJ3Byb2Nlc3NpbmcnLCAncmVhZHknLCAnZmFpbGVkJ10pLFxuICBpbmRleFZlY3RvcktleTogei5zdHJpbmcoKS5vcHRpb25hbCgpLCAvLyBlbWJlZGRpbmdzIGZpbGUgb3IgdmVjdG9yIERCIGtleVxuXG4gIGNyZWF0ZWRBdDogei5zdHJpbmcoKSxcbiAgdXBkYXRlZEF0OiB6LnN0cmluZygpLFxufSk7XG5cbmV4cG9ydCB0eXBlIERvY3VtZW50SXRlbSA9IHouaW5mZXI8dHlwZW9mIERvY3VtZW50SXRlbVNjaGVtYT47XG5cblxuLy9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBEVE9zIChBUEkgSW5wdXQpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy9cblxuLy8gQ1JFQVRFXG5leHBvcnQgY29uc3QgQ3JlYXRlRG9jdW1lbnREVE9TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGtub3dsZWRnZUJhc2VJZDogei5zdHJpbmcoKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgZmlsZUtleTogei5zdHJpbmcoKSxcbiAgdGV4dEZpbGVLZXk6IHouc3RyaW5nKClcbn0pO1xuXG5leHBvcnQgdHlwZSBDcmVhdGVEb2N1bWVudERUTyA9IHouaW5mZXI8dHlwZW9mIENyZWF0ZURvY3VtZW50RFRPU2NoZW1hPjtcblxuXG4vLyBVUERBVEVcbmV4cG9ydCBjb25zdCBVcGRhdGVEb2N1bWVudERUT1NjaGVtYSA9IHoub2JqZWN0KHtcbiAgaWQ6IHouc3RyaW5nKCksXG4gIGtub3dsZWRnZUJhc2VJZDogei5zdHJpbmcoKSwgIC8vIHJlcXVpcmVkIGZvciBsb2NhdGluZyB0aGUgU0tcbiAgbmFtZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBpbmRleFN0YXR1czogei5lbnVtKFsncGVuZGluZycsICdwcm9jZXNzaW5nJywgJ3JlYWR5JywgJ2ZhaWxlZCddKS5vcHRpb25hbCgpLFxuICBpbmRleFZlY3RvcktleTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxufSk7XG5cbmV4cG9ydCB0eXBlIFVwZGF0ZURvY3VtZW50RFRPID0gei5pbmZlcjx0eXBlb2YgVXBkYXRlRG9jdW1lbnREVE9TY2hlbWE+O1xuXG5cbi8vIERFTEVURVxuZXhwb3J0IGNvbnN0IERlbGV0ZURvY3VtZW50RFRPU2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKSxcbiAga25vd2xlZGdlQmFzZUlkOiB6LnN0cmluZygpLFxufSk7XG5cbmV4cG9ydCB0eXBlIERlbGV0ZURvY3VtZW50RFRPID0gei5pbmZlcjx0eXBlb2YgRGVsZXRlRG9jdW1lbnREVE9TY2hlbWE+O1xuIl19